/**
 * ATP synthase
 */

import { SVG } from "@svgdotjs/svg.js";
import svgContent from '!!raw-loader!../svgs/atp-synthase.svg';

const atpsynthase = ({ subunits = false, reaction = true, label = true, position = null, cRingColor = "#C7B29E", alphaSubunitColor = "#D6C2AD", betaSubunitColor = "#C7B29E", gammaSubunitColor = "#F6E8D7", iSubunitColor = "#C7B29E", iiSubunitColor = "E4D3BD" } = {}) => {

  let draw = SVG();
  draw.svg(svgContent);

  // Add modifications here
  if (!subunits) {
    let shape = draw.findOne('#atp-synthase > #subunits');
    shape.opacity(0);
  }

  if (!reaction) {
    let shape = draw.findOne('#atp-synthase > #reaction');
    shape.opacity(0);
  }

  if (!label) {
    let labelText = draw.findOne('#label')
    labelText.opacity(0);
  }

  if (cRingColor) {
    let shape = draw.findOne('#atp-synthase #c-ring path');
    shape.fill(cRingColor);
  }

  if (alphaSubunitColor) {
    let shape = draw.findOne('#atp-synthase #alpha-subunit path');
    shape.fill(alphaSubunitColor);
  }

  if (betaSubunitColor) {
    let shapes = draw.find('#atp-synthase #beta-subunit path');
    shapes.forEach(shape => shape.fill(betaSubunitColor));
  }

  if (gammaSubunitColor) {
    let shape = draw.findOne('#atp-synthase #gamma-subunit path');
    shape.fill(gammaSubunitColor);
  }

  if (iSubunitColor) {
    let shape = draw.findOne('#atp-synthase #i-subunit path');
    shape.fill(iSubunitColor);
  }

  if (iiSubunitColor) {
    let shape = draw.findOne('#atp-synthase #ii-subunit path');
    shape.fill(iiSubunitColor);
  }

  if (position) {
    let move = draw.findOne('#atp-synthase');
    move.transform({
      translateX: position - move.x(),
      origin: 'left',
    })
  }

  return draw.findOne('svg').svg(false);
}

export default atpsynthase;

export const settings = () => {

  let draw = SVG();
  draw.svg(svgContent);

  let move = draw.findOne('#atp-synthase')

  return {
    "id": "atpsynthase",
    "headerTitle": "ATP Synthase",
    "show": true,
    "options": [
      { "type": "check", "name": "subunits", "value": false, "label": "Subunit Labels" },
      { "type": "check", "name": "reaction", "value": true, "label": "Reaction Labels" },
      { "type": "check", "name": "label", "value": true, "label": "Label" },
      { "type": "color", "name": "cRingColor", "value": "#E4D3BD", "label": "c₁₄-Ring" },
      { "type": "color", "name": "alphaSubunitColor", "value": "#D6C2AD", "label": "𝛼 - Subunits" },
      { "type": "color", "name": "betaSubunitColor", "value": "#C7B29E", "label": "𝛽 - Subunits" },
      { "type": "color", "name": "gammaSubunitColor", "value": "#F6E8D7", "label": "𝛾 - Subunits" },
      { "type": "color", "name": "iSubunitColor", "value": "#C7B29E", "label": "I - Subunits" },
      { "type": "color", "name": "iiSubunitColor", "value": "#E4D3BD", "label": "II - Subunits" },
      { "type": "range", "name": "position", "value": move.x(), "label": "Position", "step": "1", "min": "0", "max": 1400 - move.width() },
    ]
  }
}

export const legend = () => {
  return `The ATP synthase is a molecular motor that catalyzes the condensation reaction of adenosine diphosphate (ADP) and inorganic phosphate (Pᵢ) to adenosine triphosphate (ATP) by utilizing a proton gradient between the stroma and lumen generated by proton deposition into the lumen by PSII water oxidation and the Q-cycle.`
}